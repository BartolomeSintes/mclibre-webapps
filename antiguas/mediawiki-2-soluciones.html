<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Soluciones (2). MediaWiki 1.22.0. Aplicaciones web. Bartolomé Sintes Marco</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="../varios/webapps.css" rel="stylesheet" type="text/css" title="mclibre" />
    <link rel="icon" href="../varios/favicon.ico" />
  </head>

  <body>
    <h1>MediaWiki 1.22.0. Soluciones (2)</h1>

    <nav>
      <p>
        <a href="../index.html"><img src="../varios/iconos/icono_webapps.svg" alt="Índice de WebApps" title="Índice de WebApps" width="48" height="31" /></a>
        <a href="#"><img src="../varios/iconos/icono_arrow_circle_up.svg" alt="Principio de la página" title="Principio de la página" width="36" height="36" /></a>
      </p>

      <div class="toc">
        <h2>
          <a href="mediawiki_marcado.html"><img src="../varios/iconos/icono_flecha_izquierda.svg" alt="Anterior" title="Anterior" width="15" height="18" /></a>
          MediaWiki 1.22 (2)
        </h2>

        <h3><a href="mediawiki_2.html">Enunciados</a></h3>
        <ul>
          <li><a href="mediawiki_2.html#ejercicio-1">1 - Cambiar el logotipo</a></li>
          <li><a href="mediawiki_2.html#ejercicio-2">2 - Wikis privados</a></li>
          <li><a href="mediawiki_2.html#ejercicio-3">3 - Editar tablas</a></li>
          <li><a href="mediawiki_2.html#ejercicio-4">4 - Subir archivos SVG</a></li>
          <li><a href="mediawiki_2.html#ejercicio-5">5 - Subir otros archivos</a></li>
          <li><a href="mediawiki_2.html#ejercicio-6">6 - Crear una galería</a></li>
          <li><a href="mediawiki_2.html#ejercicio-7">7 - Tablas colapsables</a></li>
          <li><a href="mediawiki_2.html#ejercicio-8">8 - Extensión Vector</a></li>
          <li><a href="mediawiki_2.html#ejercicio-11">11 - Copia de seguridad</a></li>
          <li><a href="mediawiki_2.html#ejercicio-12">12 - Otras extensiones</a></li>
          <li><a href="mediawiki_2.html#ejercicio-13">13 - Avisos en instalación</a></li>
          <li><a href="mediawiki_2.html#ejercicio-14">14 - EasyTimeLine</a></li>
        </ul>

        <h3>Soluciones</h3>
        <ul>
          <li><a href="#ejercicio-1">1 - Cambiar el logotipo</a></li>
          <li><a href="#ejercicio-2">2 - Wikis privados</a></li>
          <li><a href="#ejercicio-3">3 - Editar tablas</a></li>
          <li><a href="#ejercicio-4">4 - Subir archivos SVG</a></li>
          <li><a href="#ejercicio-5">5 - Subir otros archivos</a></li>
          <li><a href="#ejercicio-6">6 - Crear una galería</a></li>
          <li><a href="#ejercicio-7">7 - Tablas colapsables</a></li>
          <li><a href="#ejercicio-8">8 - Extensión Vector</a></li>
          <li><a href="#ejercicio-11">11 - Copia de seguridad</a></li>
          <li><a href="#ejercicio-12">12 - Otras extensiones</a></li>
          <li><a href="#ejercicio-13">13 - Avisos en instalación</a></li>
          <li><a href="#ejercicio-14">14 - EasyTimeLine</a></li>
        </ul>
      </div>
    </nav>
    <div class="aviso-antiguo">
      <p><img src="../varios/iconos/icono_warning.svg" alt="¡Atención!" title="¡Atención!" width="55" height="48" />Estos ejercicios corresponden a una versión antigua de MediaWiki. No están actualizados a versiones más actuales porque desde el curso 2014/15 no estoy trabajando en clase MediaWiki ya que estoy dedicando más tiempo a otras aplicaciones. He mantenido estos ejercicios en los apuntes por si le pueden servir a alguien.</p>
    </div>

    <p>En esta lección se proponen soluciones de los <a href="mediawiki_2.html">ejercicios de MediaWiki (2)</a>. Se recomienda
      intentar realizarlos primero sin recurrir a estas soluciones.</p>

    <section id="ejercicio-1">
      <h2>MediaWiki (2) 1 - Cambiar el logotipo</h2>
      <ol>
        <li>Manual MediaWiki: <a href="https://www.mediawiki.org/wiki/Manual:FAQ#How_do_I_change_the_logo.3F">https://www.mediawiki.org/wiki/Manual:FAQ#How_do_I_change_the_logo.3F</a>
          <p>Para cambiar el logotipo, hay que modificar en el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki:</p>

          <div class="codigo">
            <pre><code class="language-php">$wgLogo = "$wgStylePath/common/images/wiki.png";</code></pre>
          </div>
          <p>Para evitar que una actualización posterior de MediaWiki sustituya nuestro logo, es mejor usar un fichero con otro nombre y guardarlo en otra carpeta dentro de $wgStylePath.</p>
          <p>Cada <em>skin</em> usa un tamaño distinto para los logos (el <em>skin</em> Vector usa 160x160píxeles, pero bastantes <em>skins</em> usan 135x135 píxeles). Si se usan tamaños superiores, Vector recorta las imágenes y otros <em>skins</em> las muestran completas.</p>
        </li>
      </ol>
    </section>

    <section id="ejercicio-2">
      <h2>MediaWiki (2) 2 - Wikis privados</h2>
      <ol>
        <li>Manual MediaWiki:
          <ul>
            <li>Creación de usuarios: <a href="https://www.mediawiki.org/wiki/Manual:Account_creation">https://www.mediawiki.org/wiki/Manual:Account_creation</a></li>
            <li>Tipos de permisos: <a href="https://www.mediawiki.org/wiki/Manual:User_rights#List_of_permissions">https://www.mediawiki.org/wiki/Manual:User_rights#List_of_permissions</a>
            </li>
          </ul>
          <p>Para convertir la wiki pública en una wiki privada se puede añadir, entre otros, los siguientes valores en el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki:</p>

          <div class="codigo">
            <pre>
<code class="language-php">$wgGroupPermissions['*']['createaccount'] = false;
$wgGroupPermissions['*']['edit'] = false;
$wgGroupPermissions['*']['read'] = false;</code>
</pre>
          </div>
        </li>
      </ol>
    </section>

    <section id="ejercicio-3">
      <h2>MediaWiki (2) 3 - Editar tablas</h2>
      <ol>
        <li>Manual MediaWiki: <a href="https://www.mediawiki.org/wiki/Help:Tables">https://www.mediawiki.org/wiki/Help:Tables</a>
          <p>Manual Wikipedia: <a href="https://en.wikipedia.org/wiki/Help:Tables">https://en.wikipedia.org/wiki/Help:Tables</a></p>
          <p>El código para generar las tablas del ejemplo es el siguiente:</p>

          <div class="codigo">
            <pre>
<code class="language-configuracion">{|  class="wikitable"
|-
! Planeta
! Diámetro
|-
| Mercurio
| align="right" | 4.879,4 km
|-
| Venus
| align="right" | 12.103,6 km
|-
| Tierra
| align="right" | 12.756,2 km
|}

{| class="wikitable"
|+ Elementos químicos
|-
! align="left" | Símbolo
| align="center" | H
| align="center" | He
| align="center" | Li
|-
! align="left" | Nombre
| Hidrógeno
| Helio
| Litio
|-
! align="left" | Masa atómica
| 1,00797 u
| 4,00260 u
| 6,94174 u
|}

{| class="wikitable"
|-
| A
| colspan="3" | B
|-
| rowspan="3" | C
| colspan="2" rowspan="2" style="background-color: lightblue; color: blue; font-size: 200%" |D
| E
|-
| F
|-
| G
| H
| I
|}</code></pre>
          </div>
        </li>
      </ol>
    </section>

    <section id="ejercicio-4">
      <h2>MediaWiki (2) 4 - Subir archivos SVG</h2>
      <ol>
        <li>Para poder subir archivos SVG, hay que añadir en el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki:

          <div class="codigo">
            <pre>
<code class="language-php">$wgFileExtensions[] = 'svg';
$wgAllowTitlesInSVG = true;</code>
</pre>
          </div>
        </li>
        <li>Las imágenes SVG no se incluyen directamente en las páginas, sino que se convierten automáticamente a PNG. Para ello es necesario configurar algún convertidor de SVG a PNG:
          <ul>
            <li>Inkscape
              <p>Manual MediaWiki: <a href="https://www.mediawiki.org/wiki/Manual:$wgSVGConverters">https://www.mediawiki.org/wiki/Manual:$wgSVGConverters</a></p>
              <p>Es fácil de instalar y configurar y funciona bien.</p>
              <p>La última versión de Inkscape se puede descargar de <a href="http://www.cdlibre.org/consultar/catalogo/Graficos_Editores-graficos.html">http://www.cdlibre.org/consultar/catalogo/Graficos_Editores-graficos.html</a></p>
              <p>En el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki hay que añadir:</p>

              <div class="codigo">
                <pre>
<code class="language-php">$wgSVGConverter = 'Inkscape';
$wgSVGConverters = array(
    'Inkscape' =&gt; '"<span class="codigo-modificacion">ruta_de_Inkscape</span>\inkscape.exe" -z -w $width -f $input -e $output',
);</code>
</pre>
              </div>
            </li>
            <li>ImageMagick
              <p>Manual MediaWiki: <a href="https://www.mediawiki.org/wiki/Manual:Installing_third-party_tools">https://www.mediawiki.org/wiki/Manual:Installing_third-party_tools</a></p>
              <p>Aunque es fácil de instalar y configurar, MediaMagick no funciona demasiado bien (por ejemplo, si la imagen contiene degradados).</p>
              <p>Para Windows, se puede descargar la versión portable de <a href="http://www.imagemagick.org/script/index.php">http://www.imagemagick.org/script/index.php</a> o de <a href="https://sourceforge.net/projects/imagemagick/files/">https://sourceforge.net/projects/imagemagick/files/</a>. El fichero para Windows se llama ImageMagick-X.Y.Z-N-Q16-x86-windows.zip, y actualmente (enero de 2013) la última versión disponible es la versión 6.8.1-9 del 6 de enero de 2013). Este fichero se debe descomprimir en la carpeta de mediawiki.</p>
              <p>En el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki hay que añadir:</p>

              <div class="codigo">
                <pre>
<code class="language-php">$wgAllowTitlesInSVG = true;
$wgSVGConverter = 'ImageMagick';
$wgUseImageMagick = true;
$wgSVGConverters = array(
    'ImageMagick' =&gt; '"<span class="codigo-modificacion">ruta_de_ImageMagick</span>/convert.exe" -background white -geometry $width $input $output',
  );</code>
</pre>
              </div>
              <p>En el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki hay un par de líneas comentadas sobre Imagemagick que <strong>no</strong> es necesario modificar:</p>

              <div class="codigo">
                <pre>
<code class="language-php">#$wgUseImageMagick = true;
#$wgImageMagickConvertCommand = "/usr/bin/convert";</code>
</pre>
              </div>
            </li>
            <li>Batik
              <p>Batik es una biblioteca Java para manipular SVG. La página web es <a href="http://xmlgraphics.apache.org/batik/">http://xmlgraphics.apache.org/batik/</a>. Yo no lo he probado, pero por lo visto es muy lenta.</p>
            </li>
            <li>librsvg
              <p>librsvg es una biblioteca de visualización de SVG para GNOME. Se puede descargar de <a href="http://ftp.gnome.org/pub/GNOME/sources/librsvg/">http://ftp.gnome.org/pub/GNOME/sources/librsvg/</a></p>
              <p>Yo no lo he probado, pero por lo visto es muy rápido, pero complicado de instalar (sobre todo en Windows, aunque también en Linux) porque tiene muchas dependencias.</p>
            </li>
          </ul>
        </li>
      </ol>
    </section>

    <section id="ejercicio-5">
      <h2>MediaWiki (2) 5 - Subir otros tipos de archivos</h2>

      <ol>
        <li>En el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki hay que añadir una línea por cada formato de archivo:

          <div class="codigo">
            <pre>
<code class="language-php">$wgFileExtensions[] = 'svg';
$wgFileExtensions[] = 'pdf';</code>
</pre>
          </div>
        </li>
        <li>Manual MediaWiki: <a href="https://www.mediawiki.org/wiki/Help:Links#Internal_links">https://www.mediawiki.org/wiki/Help:Links#Internal_links</a>
          <p>Para enlazar los archivos subidos:</p>

          <div class="codigo">
            <pre><code class="language-php">[[media:nombre de archivo | texto ]</code></pre>
          </div>
        </li>
      </ol>
    </section>

    <section id="ejercicio-6">
      <h2>MediaWiki (2) 6 - Crear una galería</h2>

      <ol>
        <li>Manual Mediawiki: <a href="https://www.mediawiki.org/wiki/Help:Images#Rendering_a_gallery_of_images">https://www.mediawiki.org/wiki/Help:Images#Rendering_a_gallery_of_images</a>
          <p>Para crear una galería de imágenes:</p>

          <div class="codigo">
            <pre>
<code class="language-php">&lt;gallery&gt;
nombre del archivo de imagen | leyenda
nombre del archivo de imagen | leyenda
nombre del archivo de imagen | leyenda
&lt;/gallery&gt;</code>
</pre>
          </div>
        </li>
      </ol>
    </section>

    <section id="ejercicio-7">
      <h2>MediaWiki (2) 7 - Tablas colapsables</h2>

      <ol>
        <li>El código del ejemplo sería el siguiente:
          <ul>
            <li>En la página
              <div class="codigo">
                <pre>
<code class="language-php">Esto es un ejemplo de tabla colapsable:
{| class="wikitable collapsible collapsed"
|-
! colspan="4" | Esta tabla se puede mostrar u ocultar
|-
! !! 1 !! 2 !! 3
|- align="center"
! A
| A1 || A2 || A3
|- align="center"
! B
| B1 || B2 || B3
|}</code>
        </pre>
              </div>
            </li>
          </ul>
          <ul>
            <li>En la página <strong>http:// ... /index.php?title=MediaWiki:Common.js</strong>

              <div class="codigo">
                <pre>
<code class="language-php">/**
 * Collapsible tables *********************************************************
 *
 * Description: Allows tables to be collapsed, showing only the header. See
 *              [[Wikipedia:NavFrame]].
 * Maintainers: [[User:R. Koot]]
 */

var autoCollapse = 2;
var collapseCaption = 'ocultar';
var expandCaption = 'mostrar';

window.collapseTable = function ( tableIndex ) {
    var Button = document.getElementById( 'collapseButton' + tableIndex );
    var Table = document.getElementById( 'collapsibleTable' + tableIndex );

    if ( !Table || !Button ) {
        return false;
    }

    var Rows = Table.rows;
    var i;

    if ( Button.firstChild.data === collapseCaption ) {
        for ( i = 1; i &lt; Rows.length; i++ ) {
            Rows[i].style.display = 'none';
        }
        Button.firstChild.data = expandCaption;
    } else {
        for ( i = 1; i &lt; Rows.length; i++ ) {
            Rows[i].style.display = Rows[0].style.display;
        }
        Button.firstChild.data = collapseCaption;
    }
};

function createCollapseButtons() {
    var tableIndex = 0;
    var NavigationBoxes = {};
    var Tables = document.getElementsByTagName( 'table' );
    var i;

    function handleButtonLink( index, e ) {
        window.collapseTable( index );
        e.preventDefault();
    }

    for ( i = 0; i &lt; Tables.length; i++ ) {
        if ( $( Tables[i] ).hasClass( 'collapsible' ) ) {

            /* only add button and increment count if there is a header row to work with */
            var HeaderRow = Tables[i].getElementsByTagName( 'tr' )[0];
            if ( !HeaderRow ) continue;
            var Header = HeaderRow.getElementsByTagName( 'th' )[0];
            if ( !Header ) continue;

            NavigationBoxes[ tableIndex ] = Tables[i];
            Tables[i].setAttribute( 'id', 'collapsibleTable' + tableIndex );

            var Button     = document.createElement( 'span' );
            var ButtonLink = document.createElement( 'a' );
            var ButtonText = document.createTextNode( collapseCaption );

            Button.className = 'collapseButton';  /* Styles are declared in Common.css */

            ButtonLink.style.color = Header.style.color;
            ButtonLink.setAttribute( 'id', 'collapseButton' + tableIndex );
            ButtonLink.setAttribute( 'href', '#' );
            $( ButtonLink ).on( 'click', $.proxy( handleButtonLink, ButtonLink, tableIndex ) );
            ButtonLink.appendChild( ButtonText );

            Button.appendChild( document.createTextNode( '[' ) );
            Button.appendChild( ButtonLink );
            Button.appendChild( document.createTextNode( ']' ) );

            Header.insertBefore( Button, Header.firstChild );
            tableIndex++;
        }
    }

    for ( i = 0;  i &lt; tableIndex; i++ ) {
        if ( $( NavigationBoxes[i] ).hasClass( 'collapsed' ) || ( tableIndex &gt;= autoCollapse &amp;&amp; $( NavigationBoxes[i] ).hasClass( 'autocollapse' ) ) ) {
            window.collapseTable( i );
        }
        else if ( $( NavigationBoxes[i] ).hasClass ( 'innercollapse' ) ) {
            var element = NavigationBoxes[i];
            while ((element = element.parentNode)) {
                if ( $( element ).hasClass( 'outercollapse' ) ) {
                    window.collapseTable ( i );
                    break;
                }
            }
        }
    }
}

mw.hook( 'wikipage.content' ).add( createCollapseButtons )</code>
</pre>
              </div>
            </li>
          </ul>
        </li>
      </ol>
    </section>

    <section id="ejercicio-8">
      <h2>MediaWiki (2) 8 - Extensión Vector</h2>

      <ol>
        <li>Para ver si la extensión Vector ya está incluida en MediaWiki hay que ver si en la carpeta <strong>extensions</strong> hay una carpeta <strong>Vector</strong>.
          <p>Para ver si la extensión Vector está activada hay que abrir la página <strong>Especial:Versión</strong> (<strong>Special:Version</strong>) y ver si en el apartado Extensiones instaladas aparece la extensión Vector.</p>
        </li>
        <li>Opción EditWarning de Vector
          <ul>
            <li>Con la extensión Vector sin activar, comprobar que en la página <strong>Especial:Preferencias</strong> (<strong>Special:Preferences</strong>), en la pestaña Edición, apartado Opciones avanzadas, <strong>no</strong> aparece la opción "Advertirme cuando abandone una página editada con cambios sin grabar".</li>
            <li>Para activar Vector, añadir en el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki:
              <div class="codigo">
                <pre><code class="language-php">require_once( "$IP/extensions/Vector/Vector.php" );</code></pre>
              </div>
            </li>
            <li>Una vez activada, en la página <strong>Especial:Versión</strong> (<strong>Special:Version</strong>) debe aparecer la extensión vector y en la página <strong>Especial:Preferencias</strong> (<strong>Special:Preferences</strong>) debe aparecer la opción "Advertirme cuando abandone una página editada con cambios sin grabar".</li>
            <li>Para que la opción "Advertirme cuando abandone una página editada con cambios sin grabar" aparezca de forma predeterminada, añadir en el archivo de configuración <strong>LocalSettings.php</strong> de MediaWiki:
              <div class="codigo">
                <pre><code class="language-php">$wgDefaultUserOptions['useeditwarning'] = 1;</code></pre>
              </div>
            </li>
          </ul>
        </li>
      </ol>
    </section>

    <section id="ejercicio-11">
      <h2>MediaWiki (2) Ampliación 1 - Copia de seguridad</h2>

      <p class="incompleto">Por escribir</p>
    </section>

    <section id="ejercicio-12">
      <h2>MediaWiki (2) Ampliación 2 - Otras extensiones</h2>

      <p class="incompleto">Por escribir</p>
    </section>

    <section id="ejercicio-13">
      <h2>MediaWiki (2) Ampliación 3 - Avisos en instalación</h2>

      <p class="incompleto">Por escribir</p>
    </section>

    <section id="ejercicio-14">
      <h2>MediaWiki (2) Ampliación 4 - Líneas de tiempo (EasyTimeLine)</h2>

      <p class="incompleto">Por escribir</p>
    </section>

    <section id="ejercicio-15">
      <h2>MediaWiki (2) XX - Otros</h2>

      <table class="tabla-con-borde">
        <tbody>
          <tr>
            <th colspan="2">Texto</th>
          </tr>
          <tr>
            <th>Resultado</th>
            <th>Sintaxis</th>
          </tr>
          <tr>
            <td>Cita</td>
            <td><code>{{Cita|Texto de la cita|[[Autor]], ''Obra''}}</code></td>
          </tr>
        </tbody>
      </table>
    </section>

    <footer>
      <p class="ultmod">Última modificación de esta página: 9 de enero de 2014</p>

      <p class="licencia"><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.es_ES"><img src="../varios/iconos/icono_cc_by_sa.svg" alt="Licencia Creative Commons" title="Licencia Creative Commons BY-SA" width="120" height="42" /></a><br />
        Esta página forma parte del curso <strong><a href="http://www.mclibre.org/consultar/webapps/">Aplicaciones web</a></strong> por <a href="http://www.mclibre.org/" rel="author">Bartolomé Sintes Marco</a><br />
        que se distribuye bajo una <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.es_ES">Licencia Creative Commons BY-SA 4.0</a>.</p>
    </footer>
  </body>
</html>
