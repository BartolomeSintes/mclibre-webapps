<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Ejercicios (1). ownCloud. Aplicaciones web. Bartolomé Sintes Marco. www.mclibre.org</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../varios/webapps.css" title="mclibre" />
  <link rel="icon" href="../varios/favicon.ico" />
</head>

<body>
  <h1>ownCloud - Ejercicios (1) - Enunciados</h1>

  <nav>
    <p>
      <a href="../index.html"><img src="../varios/iconos/icono-webapps.svg" alt="Índice de WebApps" title="Índice de WebApps" width="48" height="31" /></a>
      <a href="#"><img src="../varios/iconos/icono-arrow-circle-up.svg" alt="Principio de la página" title="Principio de la página" width="36" height="36" /></a>
    </p>

    <div class="toc">
      <h2>
        <img src="../varios/iconos/icono-vacio.svg" alt="" width="15" height="15" /> ownCloud (1)
        <a href="owncloud-2.html"><img src="../varios/iconos/icono-flecha-derecha.svg" alt="Siguiente" title="Siguiente" width="15" height="18" /></a>
      </h2>

      <h3><a href="#">Enunciados</a></h3>
      <ul>
        <li><a href="#ejercicio-1">1 - Descargar</a></li>
        <li><a href="#ejercicio-2">2 - Instalar</a></li>
        <li><a href="#ejercicio-3">3 - Configuración básica</a></li>
        <li><a href="#ejercicio-4">4 - Acceder mediante https</a></li>
        <li><a href="#ejercicio-5">5 - Habilitar HTTP STS</a></li>
        <li><a href="#ejercicio-6">6 - Acceder Filezilla/WinSCP</a></li>
      </ul>

      <h3><a href="owncloud-1-soluciones.html">Soluciones</a></h3>
      <ul>
        <li><a href="owncloud-1-soluciones.html#ejercicio-1">1 - Descargar</a></li>
        <li><a href="owncloud-1-soluciones.html#ejercicio-2">2 - Instalar</a></li>
        <li><a href="owncloud-1-soluciones.html#ejercicio-3">3 - Configuración básica</a></li>
        <li><a href="owncloud-1-soluciones.html#ejercicio-4">4 - Acceder mediante https</a></li>
        <li><a href="owncloud-1-soluciones.html#ejercicio-5">5 - Habilitar HTTP STS</a></li>
        <li><a href="owncloud-1-soluciones.html#ejercicio-6">6 - Acceder Filezilla/WinSCP</a></li>
      </ul>
    </div>
  </nav>

  <div class="aviso-antiguo">
    <p><img src="../varios/iconos/icono-warning.svg" alt="¡Atención!" width="55" height="48" />Estos ejercicios corresponden a una versión antigua de ownCloud. No están actualizados a versiones más actuales porque desde el curso 2016/17 no estoy trabajando en clase ownCloud, sino <a href="../lecciones/nextcloud.html">Nextcloud</a>. He mantenido estos ejercicios en los apuntes por si le pueden servir a alguien.</p>
  </div>

  <p>En esta lección se proponen ejercicios para conocer y utilizar <strong>ownCloud</strong>. Se pueden consultar las <a href="owncloud-1-soluciones.html">soluciones de estos ejercicios de ownCloud</a>, aunque se recomienda intentar realizarlos primero sin recurrir a estas soluciones. A continuación se pueden realizar los <a href="owncloud-2.html">ejercicios (2) de ownCloud</a>, en los que se amplian las funcionalidades de ownCloud.</p>

  <section id="ejercicio-1">
    <h2>ownCloud (1) 1 - Descargar</h2>

    <p>En este ejercicio se trata de descargar y descomprimir ownCloud en el servidor local.</p>
    <ol>
      <li>Visite la página web del proyecto ownCloud.</li>
      <li>Descargue la máquina virtual de Bitnami que incluye la versión <strong>ownCloud 8.2.1</strong>, publicada el 17 de noviembre de 2015. Se recomienda esa versión ya que estos ejercicios se han preparado para ella.
        <p>Si la máquina virtual de la versión <strong>ownCloud 8.2.1</strong> ya no está disponible en la web del programa, puede descargarla desde la página de <a href="../otros/descarga-aplicaciones.html">Descarga de aplicaciones</a>.</p>
      </li>
      <li>Descomprima la máquina virtual en una carpeta (no tiene por qué ser la carpeta Aplicaciones)</li>
    </ol>
  </section>

  <section id="ejercicio-2">
    <h2>ownCloud (1) 2 - Instalar</h2>

    <p>En este ejercicio se trata de instalar ownCloud.</p>
    <ol>
      <li>Abra en VirtualBox o VMware la máquina virtual de ownCloud.</li>
      <li>Ponga en marcha la máquina virtual. En ella se indica la dirección IP asignada y los datos del usuario administrador tanto del sistema operativo como de la aplicación.
        <p><img src="../varios/iconos/icono-warning.svg" alt="¡Atención!" width="55" height="48" />No es necesario entrar en la máquina virtual.</p>
        <p class="captura">
          <img src="img/owncloud-8-2/1-2-e-1-instalacion.png" alt="ownCloud. Instalación" width="738" height="482" />
        </p>
      </li>
      <li>Abra <strong>http:/192.168.XXX.YYY</strong> en el navegador y compruebe que se abre la página inicial de ownCloud:
        <p class="captura">
          <img src="img/owncloud-8-2/1-2-e-2-instalacion.png" alt="ownCloud. Instalación" width="350" height="300" />
        </p>
      </li>
      <li>Entre en ownCloud como administrador y compruebe que puede ver el escritorio de ownCloud:
        <p class="captura">
          <img src="img/owncloud-8-2/1-2-e-3-instalacion.png" alt="ownCloud. Instalación" width="1008" height="382" />
        </p>
      </li>
      <li>Salga de ownCloud y compruebe que puede volver a entrar como administrador.</li>
    </ol>
  </section>

  <section id="ejercicio-3">
    <h2>ownCloud (1) 3 - Configuración básica</h2>

    <p>En este ejercicio se trata de realizar la configuración básica de ownCloud:</p>

    <h3>Cambio de idioma</h3>
    <ol>
      <li>Cambie el idioma del interfaz del usuario administrador al español.
        <p class="captura">
          <img src="img/owncloud-8-2/1-3-e-1-idioma.png" alt="ownCloud. idioma" width="1008" height="300" />
        </p>
      </li>
    </ol>
  </section>

  <section id="ejercicio-4">
    <h2>ownCloud (1) 4 - Acceder mediante https</h2>

    <p>Referencia: <a href="https://doc.owncloud.org/server/8.2/admin_manual/configuration_server/harden_server.html">https://doc.owncloud.org/server/8.2/admin_manual/configuration_server/harden_server.html</a></p>
    <ol>
      <li>Entre en ownCloud como administrador mediante una conexión <strong>no</strong> cifrada <strong>http://192.168.XXX.YYY/...</strong> En el panel de administración, compruebe que se muestra el aviso siguiente:
        <p class="captura">
          <img src="img/owncloud-8-2/1-4-e-1-https.png" alt="ownCloud. Conexión no segura" width="1008" height="160" />
        </p>
      </li>
      <li>Configure el servidor Apache para forzar el acceso mediante https.
        <p><img src="../varios/iconos/icono-warning.svg" alt="¡Atención!" width="55" height="48" />Para ello, es necesario entrar en la máquina virtual. En la lección <a href="../lecciones/bitnami-varios.html">Bitnami Varios</a> se comenta cómo realizar operaciones básicas en las máquinas virtuales de Bitnami.</p>
        <p>Se puede hacer de dos formas distintas, modificando el archivo de configuración de Apache httpd.conf y reiniciando el servidor:</p>
        <p class="incompleto"><img src="../varios/iconos/icono-warning.svg" alt="¡Atención!" width="55" height="48" />Antes de modificar un archivo de configuración se recomienda siempre hacer una copia del archivo original.</p>
        <ul>
          <li>Añada la directiva SSLRequireSSL en la directiva del directorio raíz. De esta forma sólo se atenderán las peticiones https.

            <div class="codigo">
              <pre>
<code class="language-configuracion">&lt;Directory /&gt;
    AllowOverride none
    Require all denied
    <span class="codigo-modificacion">SSLRequireSSL</span>
&lt;/Directory&gt;</code>
</pre>
            </div>
          </li>
          <li>Añada una directiva VirtualHost que redirija las peticiones http a https.

            <div class="codigo">
              <pre>
<code class="language-configuracion">&lt;VirtualHost 192.168.XX.YY:80&gt;
  Servername 192.168.XX.YY
  Redirect permanent / https:192.168.XX.YY/
&lt;/VirtualHost&gt;</code>
</pre>
            </div>
          </li>
        </ul>
      </li>
      <li>Si se muestre un aviso de seguridad por no disponer el servidor de un certificado de seguridad válido, será necesario indicar al navegador que se confíe en la identificación del sitio.<br />

        <p class="captura">
          <img src="img/owncloud-8-2/1-4-e-2-https.png" alt="ownCloud. Conexión no segura" width="710" height="430" />
        </p>
      </li>
      <li>Una vez habilitada la opción de forzar https, salga de ownCloud y compruebe que, dependiendo de cómo se ha modificado httpd.conf, si se accede de nuevo mediante la dirección <strong>http://192.168.XXX.YYY/...</strong>
        <ul>
          <li>... o bien se muestra la página de Acceso prohibido (que corresponde a un código de estado HTTP 403)
            <p class="captura">
              <img src="img/owncloud-8-2/1-4-e-3-https.png" alt="ownCloud. Conexión no segura" width="400" height="100" />
            </p>
          </li>
          <li>... o bien se redirecciona automáticamente a <strong>https://192.168.XXX.YYY/...</strong>
            <p class="captura">
              <img src="img/owncloud-8-2/1-4-e-4-https.png" alt="ownCloud. Conexión no segura" width="650" height="180" />
            </p>
          </li>
        </ul>
      </li>
    </ol>
  </section>

  <section id="ejercicio-5">
    <h2>ownCloud (1) 5 - Habilitar HTTP Strict Transport Security</h2>

    <p>Referencia: <a href="https://doc.owncloud.org/server/8.2/admin_manual/configuration_server/harden_server.html">https://doc.owncloud.org/server/8.2/admin_manual/configuration_server/harden_server.html</a></p>
    <ol>
      <li>Entre en ownCloud como administrador. En el panel de administración, compruebe que se muestra el aviso siguiente:
        <p class="captura">
          <img src="img/owncloud-8-2/1-5-e-1-sts.png" alt="ownCloud. HTTP Strict Transport Security" width="1008" height="180" />
        </p>
      </li>
      <li>Configure el servidor Apache para forzar el uso de HTTP Strict Transport Security
        <p>Para ello, puede añadir una directiva VirtualHost en el archivo de configuración de Apache httpd.conf y reiniciar el servidor:</p>

        <div class="codigo">
          <pre>
<code class="language-configuracion">&lt;VirtualHost 192.168.XX.YY:443&gt;
  ServerName 192.168.XX.YY

  SSLEngine on
  SSLCertificateFile      /opt/bitnami/apps/owncloud/conf/certs/server.crt
  SSLCertificateKeyFile   /opt/bitnami/apps/owncloud/conf/certs/server.key

  &lt;IfModule mod_headers.c&gt;
    Header always set Strict-Transport-Security "max-age=15768000; includeSubDomains; preload"
  &lt;/IfModule&gt;
&lt;/VirtualHost&gt;</code>
</pre>
        </div>
      </li>
      <li>Por motivos que deconozco, al actualizar el panel de administración se deja de ver ownCloud y se muestra otra página web del servidor.
        <p class="captura">
          <img src="img/owncloud-8-2/1-5-e-2-sts.png" alt="ownCloud. HTTP Strict Transport Security" width="991" height="290" />
        </p>
      </li>
      <li>Puede resolver este problema cambiando la directiva Document Root en el archivo de configuración de Apache httpd.conf y reiniciando el servidor:

        <div class="codigo">
          <pre>
<code class="language-configuracion">DocumentRoot "/opt/bitnami/apps/owncloud/htdocs"
&lt;Directory  "/opt/bitnami/apps/owncloud/htdocs"&gt;
 ...</code>
 </pre>
        </div>
      </li>
      <li>En el panel de administración, compruebe que ya no se muestra ningún aviso de seguridad:
        <p class="captura">
          <img src="img/owncloud-8-2/1-5-e-3-sts.png" alt="ownCloud. HTTP Strict Transport Security" width="1008" height="240" />
        </p>
      </li>
    </ol>

    <p>Referencias:</p>
    <ul>
      <li>http://robsnotebook.com/xampp-ssl-encrypt-passwords</li>
      <li>http://www.digitallycreated.net/Blog/38/using-makecert-to-create-certificates-for-development</li>
      <li>SSL: <a href="https://docs.bitnami.com/?page=components&name=apache#How_to_enable_HTTPS_support_with_SSL_certificates">https://docs.bitnami.com/?page=components&name=apache#How_to_enable_HTTPS_support_with_SSL_certificates</a></li>
      <li>Bitnami Virtual Appliances Quick Start Guide: <a href="https://docs.bitnami.com/virtual-machine/">https://docs.bitnami.com/virtual-machine/</a></li>
      <li>ownCloud Hardening and Security Guidance: <a href="https://doc.owncloud.org/server/8.2/admin_manual/configuration_server/harden_server.html">https://doc.owncloud.org/server/8.2/admin_manual/configuration_server/harden_server.html</a></li>
      <li>Mozilla SSL configuration generator: <a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">https://mozilla.github.io/server-side-tls/ssl-config-generator/</a></li>
    </ul>
  </section>

  <section id="ejercicio-6">
    <h2>ownCloud (1) 6 - Acceder mediante Filezilla o WinSCP</h2>

    <h3>Acceso por FTP</h3>
    <ol>
      <li>Configure el servicio VSFTP de la máquina virtual para permitir conexiones FTP. Para ello, consulte la ayuda de Bitnami <a href="https://docs.bitnami.com/?page=components&name=vsftpd">https://docs.bitnami.com/?page=components&name=vsftpd</a></li>
      <li>Instale Filezilla o WinSCP y conéctese a la máquina virtual:
        <p class="captura">
          <img src="img/owncloud-8-2/1-6-e-1-ftp.png" alt="ownCloud. WinSCP" width="896" height="300" />
        </p>
        <p class="captura">
          <img src="img/owncloud-8-2/1-6-e-2-ftp.png" alt="ownCloud. FileZilla" width="900" height="440" />
        </p>
      </li>
      <li>Compruebe que también puede conectarse con el navegador:
        <p class="captura">
          <img src="img/owncloud-8-2/1-6-e-3-ftp.png" alt="ownCloud. FileZilla" width="800" height="370" />
        </p>
      </li>
    </ol>

    <h3>Acceso por SFTP</h3>

    <p class="incompleto"><img src="../varios/iconos/icono-en-construccion.svg" alt="En construcción" width="55" height="48" />Esta parte del ejercicio está por redactar. No creo que me dé tiempo a prepararlo este curso. Se trataría de conectarse a la máquina virtual con WinSCP o Filezilla por SFTP (o FTPS).</p>

    <p>Referencias:</p>
    <ul>
      <li>WinSCP: <a href="https://docs.bitnami.com/bch/faq/get-started/connect-ssh/">https://docs.bitnami.com/bch/faq/get-started/connect-ssh/</a></li>
    </ul>
  </section>

  <footer>
    <p class="ultmod">Última modificación de esta página: 13 de enero de 2016</p>

    <p class="licencia">
      <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.es_ES"><img src="../varios/iconos/icono-cc-by-sa.svg" alt="Licencia Creative Commons" title="Licencia Creative Commons BY-SA" width="120" height="42" /></a><br />
      Esta página forma parte del curso <strong><a href="http://www.mclibre.org/consultar/webapps/">Aplicaciones web</a></strong> por <a href="http://www.mclibre.org/" rel="author">Bartolomé Sintes Marco</a><br />
      que se distribuye bajo una <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.es_ES">Licencia Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional (CC BY-SA 4.0)</a>.
    </p>
  </footer>
</body>
</html>
